<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <title>EASY EARN BD</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- AD SDK SCRIPT -->
  <script src='//libtl.com/sdk.js' data-zone='9659158' data-sdk='show_9659158'></script>
  <style>
    * {
      box-sizing: border-box;
      font-family: 'Inter', sans-serif;
      transition: all 0.3s ease;
    }
    
    body {
      margin: 0;
      padding: 30px 15px;
      background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
      color: #f0f0f0;
    }
    
    body.dark-theme {
      background: linear-gradient(135deg, #0a061e, #1d1940, #141329);
    }
    
    .hidden { display: none !important; }
    
    .app, .ad-page, .referral-page, .notice-page, .withdraw-page, 
    .settings-page, .support-page, .profile-page, .history-page,
    .welcome-page {
      background: rgba(30, 26, 62, 0.65);
      backdrop-filter: blur(12px);
      border-radius: 24px;
      padding: 30px;
      width: 100%;
      max-width: 420px;
      box-shadow: 0 16px 40px rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.08);
    }
    
    .app-name {
      text-align: center;
      font-size: 32px;
      font-weight: 700;
      margin-bottom: 20px;
      background: linear-gradient(90deg, #00b09b, #96c93d);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      letter-spacing: -0.5px;
      text-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }
    
    .balance-section {
      background: linear-gradient(135deg, #1a1a3a, #2d2b55);
      color: white;
      border-radius: 20px;
      padding: 25px;
      margin-bottom: 30px;
      text-align: center;
      position: relative;
      overflow: hidden;
      border: 1px solid rgba(0, 176, 155, 0.15);
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.25);
    }
    
    .balance-section::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #00b09b, #96c93d);
    }
    
    .balance-section h2 { 
      margin: 0 0 10px; 
      font-size: 24px; 
      font-weight: 600;
      letter-spacing: -0.3px;
    }
    
    .balance-section p { 
      margin: 8px 0; 
      font-size: 17px; 
      font-weight: 500;
      color: rgba(255, 255, 255, 0.85);
    }
    
    .balance-section strong {
      font-weight: 600;
      color: #f0f0f0;
    }
    
    .grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
    }
    
    .card {
      background: linear-gradient(135deg, rgba(40, 36, 76, 0.7), rgba(30, 26, 62, 0.5));
      border-radius: 18px;
      padding: 20px 10px;
      text-align: center;
      cursor: pointer;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
      border: 1px solid rgba(255, 255, 255, 0.08);
      position: relative;
      overflow: hidden;
    }
    
    .card::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #00b09b, #96c93d);
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 32px rgba(0, 0, 0, 0.35);
      border-color: rgba(0, 176, 155, 0.25);
    }
    
    .card:hover::before {
      opacity: 1;
    }
    
    .card:hover i {
      transform: scale(1.1);
    }
    
    .card i {
      font-size: 28px;
      color: #00b09b;
      margin-bottom: 12px;
      transition: all 0.3s ease;
    }
    
    .card span {
      display: block;
      font-size: 14px;
      font-weight: 500;
      color: rgba(255, 255, 255, 0.85);
      letter-spacing: -0.2px;
    }
    
    .back-btn {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 25px;
      color: #f0f0f0;
      cursor: pointer;
      background: rgba(40, 36, 76, 0.7);
      border-radius: 12px;
      padding: 12px 20px;
      width: fit-content;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.1);
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .back-btn:hover {
      background: rgba(50, 46, 86, 0.8);
      transform: translateX(-3px);
    }
    
    .back-btn i {
      font-size: 18px;
    }
    
    .quiz-buttons {
      display: flex;
      flex-direction: column;
      gap: 20px;
      margin-bottom: 40px;
    }
    
    .quiz-buttons button {
      background: linear-gradient(135deg, #00b09b, #96c93d);
      color: #1a1a2e;
      border: none;
      padding: 15px;
      font-size: 16px;
      font-weight: 600;
      border-radius: 14px;
      width: 100%;
      cursor: pointer;
      box-shadow: 0 6px 16px rgba(0, 176, 155, 0.3);
      transition: all 0.3s ease;
      letter-spacing: -0.3px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }
    
    .quiz-buttons button:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0, 176, 155, 0.4);
    }
    
    .modal {
      position: fixed;
      z-index: 9999;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(10, 6, 30, 0.9);
      display: flex;
      justify-content: center;
      align-items: center;
    }
    
    .modal-content {
      background: linear-gradient(135deg, #1a1a3a, #2d2b55);
      padding: 30px;
      border-radius: 20px;
      width: 90%;
      max-width: 420px;
      text-align: center;
      position: relative;
      box-shadow: 0 16px 40px rgba(0, 0, 0, 0.4);
      border: 1px solid rgba(0, 176, 155, 0.15);
    }
    
    .modal-content::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #00b09b, #96c93d);
    }
    
    .modal .close {
      position: absolute;
      top: 15px;
      right: 20px;
      font-size: 26px;
      font-weight: bold;
      cursor: pointer;
      color: #00b09b;
      transition: all 0.3s ease;
    }
    
    .modal .close:hover {
      transform: scale(1.1);
      color: #f0f0f0;
    }
    
    .quiz-question {
      font-weight: 600;
      margin-bottom: 25px;
      font-size: 19px;
      line-height: 1.5;
    }
    
    .timer {
      font-size: 18px;
      color: #00b09b;
      font-weight: 700;
      margin-bottom: 20px;
    }
    
    .quiz-options button {
      background: rgba(40, 36, 76, 0.7);
      color: #f0f0f0;
      border: 1px solid rgba(255, 255, 255, 0.1);
      padding: 14px;
      margin: 12px 0;
      width: 100%;
      border-radius: 12px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 500;
      transition: all 0.3s ease;
    }
    
    .quiz-options button:hover {
      background: rgba(50, 46, 86, 0.9);
      border-color: rgba(0, 176, 155, 0.3);
    }
    
    .referral-page input {
      width: 100%;
      padding: 14px;
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      font-size: 15px;
      background: rgba(40, 36, 76, 0.5);
      color: #f0f0f0;
      margin-bottom: 15px;
    }
    
    .referral-page input:focus {
      outline: none;
      border-color: rgba(0, 176, 155, 0.3);
    }
    
    .notice-content, .withdraw-form, .theme-options, .support-options, .user-stats, .history-item {
      background: rgba(40, 36, 76, 0.6);
      border-radius: 20px;
      padding: 25px;
      margin-top: 25px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.08);
    }
    
    .notice-content h2, .withdraw-form h2, .support-options h2, .profile-page h2, .history-page h2 {
      color: #00b09b;
      margin-top: 0;
      text-align: center;
      font-size: 24px;
      margin-bottom: 20px;
      letter-spacing: -0.5px;
    }
    
    .notice-content p, .withdraw-form p, .support-options p, .user-stats p {
      line-height: 1.7;
      font-size: 16px;
      margin-bottom: 15px;
      color: rgba(255, 255, 255, 0.85);
    }
    
    .notice-content strong, .withdraw-form strong, .support-options strong {
      color: #00b09b;
      font-weight: 600;
    }
    
    .theme-btn, .support-btn {
      display: flex;
      align-items: center;
      justify-content: flex-start;
      padding: 18px;
      margin: 18px 0;
      border-radius: 16px;
      cursor: pointer;
      background: rgba(40, 36, 76, 0.7);
      border: 1px solid rgba(255, 255, 255, 0.1);
      font-weight: 600;
      transition: all 0.3s ease;
    }
    
    .theme-btn:hover, .support-btn:hover {
      background: rgba(50, 46, 86, 0.8);
      transform: translateY(-3px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }
    
    .theme-btn i, .support-btn i {
      margin-right: 15px;
      font-size: 24px;
      color: #00b09b;
    }
    
    .light-btn {
      background: rgba(40, 36, 76, 0.7);
      color: #f0f0f0;
    }
    
    .dark-btn {
      background: rgba(40, 36, 76, 0.7);
      color: #f0f0f0;
    }
    
    .withdraw-form input, .withdraw-form select {
      width: 100%;
      padding: 15px;
      margin: 15px 0;
      border-radius: 14px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      font-size: 16px;
      background: rgba(40, 36, 76, 0.5);
      color: #f0f0f0;
    }
    
    .withdraw-form select {
      appearance: none;
      background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%2300b09b' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
      background-repeat: no-repeat;
      background-position: right 15px center;
      background-size: 16px;
    }
    
    .withdraw-form button {
      background: linear-gradient(135deg, #00b09b, #96c93d);
      color: #1a1a2e;
      border: none;
      padding: 16px;
      font-size: 17px;
      font-weight: 600;
      border-radius: 14px;
      width: 100%;
      cursor: pointer;
      margin-top: 20px;
      box-shadow: 0 6px 16px rgba(0, 176, 155, 0.3);
      transition: all 0.3s ease;
    }
    
    .withdraw-form button:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0, 176, 155, 0.4);
    }
    
    .user-stats div {
      margin: 15px 0;
      padding: 15px;
      background: rgba(30, 26, 62, 0.5);
      border-radius: 14px;
      display: flex;
      justify-content: space-between;
      border: 1px solid rgba(255, 255, 255, 0.08);
    }
    
    .history-item {
      margin-bottom: 20px;
      padding: 20px;
      background: rgba(40, 36, 76, 0.6);
      border-radius: 16px;
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.08);
    }
    
    .history-item div {
      display: flex;
      justify-content: space-between;
      margin: 12px 0;
      padding-bottom: 10px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }
    
    .history-item div:last-child {
      border-bottom: none;
      padding-bottom: 0;
    }
    
    .level-bar {
      height: 16px;
      background-color: rgba(40, 36, 76, 0.8);
      border-radius: 10px;
      margin: 20px 0 10px;
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.1);
      position: relative;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2) inset;
    }
    
    .level-progress {
      height: 100%;
      background: linear-gradient(90deg, #ff8c00, #ff0080, #00b09b);
      border-radius: 10px;
      transition: width 0.5s ease;
      box-shadow: 0 0 15px rgba(255, 0, 128, 0.4);
      position: relative;
      overflow: hidden;
    }
    
    .level-progress::after {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(90deg, 
        rgba(255,255,255,0.1) 0%, 
        rgba(255,255,255,0.3) 50%, 
        rgba(255,255,255,0.1) 100%);
      animation: shimmer 2s infinite linear;
    }
    
    @keyframes shimmer {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }
    
    .section-title {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      margin-bottom: 25px;
    }
    
    .section-title i {
      font-size: 28px;
      color: #00b09b;
    }
    
    .copy-btn {
      background: rgba(40, 36, 76, 0.7);
      color: #f0f0f0;
      border: 1px solid rgba(255, 255, 255, 0.1);
      padding: 10px 18px;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 500;
    }
    
    .copy-btn:hover {
      background: rgba(50, 46, 86, 0.8);
      border-color: rgba(0, 176, 155, 0.3);
    }
    
    .share-btn {
      background: linear-gradient(135deg, #0088cc, #006699);
      color: white;
      border: none;
      padding: 14px 20px;
      border-radius: 14px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      width: 100%;
      margin-top: 15px;
      transition: all 0.3s ease;
    }
    
    .share-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 16px rgba(0, 136, 204, 0.4);
    }
    
    .referral-count {
      background: linear-gradient(135deg, #1a1a3a, #2d2b55);
      padding: 20px;
      border-radius: 18px;
      text-align: center;
      margin-top: 25px;
      border: 1px solid rgba(0, 176, 155, 0.15);
    }
    
    .referral-count h3 {
      font-size: 36px;
      margin: 10px 0;
      color: #00b09b;
    }
    
    .earn-text {
      color: #00b09b;
    }
    
    .pulse {
      animation: pulse 1.5s infinite;
    }
    
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    
    /* Developer text animation */
    .developer-container {
      position: relative;
      overflow: hidden;
      height: 40px;
      margin-top: 25px;
      border-radius: 12px;
      background: rgba(30, 26, 62, 0.4);
    }
    
    .developer-text {
      position: absolute;
      white-space: nowrap;
      font-size: 18px;
      font-weight: bold;
      color: rgba(255, 255, 255, 0.7);
      text-shadow: 0 0 10px rgba(0, 176, 155, 0.5);
      padding: 10px 0;
      animation: slide 15s linear infinite;
      width: 100%;
    }
    
    @keyframes slide {
      0% { transform: translateX(100%); }
      100% { transform: translateX(-100%); }
    }
    
    /* Welcome page styles */
    .welcome-content {
      text-align: center;
      padding: 30px;
    }
    
    .welcome-content h2 {
      font-size: 28px;
      margin-bottom: 25px;
      color: #00b09b;
    }
    
    .welcome-content p {
      margin-bottom: 20px;
      font-size: 18px;
      color: rgba(255, 255, 255, 0.85);
    }
    
    .welcome-content input {
      width: 100%;
      padding: 15px;
      border-radius: 14px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      font-size: 16px;
      background: rgba(40, 36, 76, 0.5);
      color: #f0f0f0;
      margin-bottom: 20px;
      text-align: center;
    }
    
    .welcome-content input:focus {
      outline: none;
      border-color: rgba(0, 176, 155, 0.3);
    }
    
    .confirm-btn {
      background: linear-gradient(135deg, #00b09b, #96c93d);
      color: #1a1a2e;
      border: none;
      padding: 16px;
      font-size: 17px;
      font-weight: 600;
      border-radius: 14px;
      width: 100%;
      cursor: pointer;
      box-shadow: 0 6px 16px rgba(0, 176, 155, 0.3);
      transition: all 0.3s ease;
    }
    
    .confirm-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0, 176, 155, 0.4);
    }
    
    /* Level indicator */
    .level-indicator {
      display: flex;
      justify-content: space-between;
      margin-top: 5px;
      font-size: 12px;
      color: rgba(255, 255, 255, 0.7);
    }
    
    .progress-percentage {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 10px;
      font-weight: bold;
      color: white;
      text-shadow: 0 0 3px rgba(0,0,0,0.8);
      z-index: 2;
    }
    
    /* Toast notifications */
    .toast {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(30, 26, 62, 0.9);
      color: white;
      padding: 15px 30px;
      border-radius: 12px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
      z-index: 1000;
      opacity: 0;
      transition: opacity 0.3s ease;
      border-left: 4px solid #00b09b;
    }
    
    .toast.show {
      opacity: 1;
    }
    
    /* New styles for ad popup */
    .ad-result-container {
      text-align: center;
      padding: 20px;
    }
    
    .ad-result-container p {
      font-size: 18px;
      margin-bottom: 20px;
    }
    
    .ad-watch-btn {
      background: linear-gradient(135deg, #ff8c00, #ff0080);
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s ease;
    }
    
    .ad-watch-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 16px rgba(255, 140, 0, 0.4);
    }
    
    /* Responsive adjustments */
    @media (max-width: 480px) {
      .grid {
        gap: 15px;
      }
      
      .card {
        padding: 15px 8px;
      }
      
      .card i {
        font-size: 24px;
      }
      
      .app, .ad-page, .referral-page, .notice-page, .withdraw-page, 
      .settings-page, .support-page, .profile-page, .history-page,
      .welcome-page {
        padding: 20px;
      }
    }
  </style>
</head>
<body id="appBody" class="dark-theme">
<!-- Welcome Page for New Users -->
<div class="welcome-page" id="welcomePage">
  <div class="welcome-content">
    <h2>‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ EASY EARN BD</h2>
    <p>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡¶§‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®:</p>
    <input type="text" id="userNameInput" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ" maxlength="20" />
    <button class="confirm-btn" onclick="saveUserName()">
      <i class="fas fa-check"></i> ‡¶ï‡¶®‡¶´‡¶æ‡¶∞‡ßç‡¶Æ
    </button>
  </div>
</div>

<!-- Main App Pages -->
<div class="app hidden" id="homePage">
  <div class="app-name pulse">EASY EARN BD</div>
  <div class="balance-section">
    <h2 id="username">Loading...</h2>
    <p>Balance: <span class="earn-text">‡ß≥<span id="balance">0.00</span></span></p>
    <p>Score: <span class="earn-text"><span id="score">0</span></span> | Level: <span class="earn-text"><span id="level">0</span></span></p>
    <div class="level-bar">
      <div class="level-progress" id="levelProgress" style="width: 0%">
        <div class="progress-percentage" id="progressPercentage">0%</div>
      </div>
    </div>
    <div class="level-indicator">
      <span>0%</span>
      <span>100%</span>
    </div>
  </div>
  <div class="grid">
    <div class="card" onclick="goToAdPage()">
      <i class="fas fa-ad"></i>
      <span>Watch Ad</span>
    </div>
    <div class="card" onclick="goToNoticePage()">
      <i class="fas fa-bullhorn"></i>
      <span>Notice</span>
    </div>
    <div class="card" onclick="goToProfilePage()">
      <i class="fas fa-user"></i>
      <span>Profile</span>
    </div>
    <div class="card" onclick="openTelegramChannel()">
      <i class="fab fa-telegram"></i>
      <span>Channel</span>
    </div>
    <div class="card" onclick="goToWithdrawPage()">
      <i class="fas fa-wallet"></i>
      <span>Withdraw</span>
    </div>
    <div class="card" onclick="goToHistoryPage()">
      <i class="fas fa-history"></i>
      <span>History</span>
    </div>
    <div class="card" onclick="goToSupportPage()">
      <i class="fas fa-headset"></i>
      <span>Support</span>
    </div>
    <div class="card" onclick="goToReferralPage()">
      <i class="fas fa-user-friends"></i>
      <span>Refer</span>
    </div>
    <div class="card" onclick="goToSettingsPage()">
      <i class="fas fa-cog"></i>
      <span>Settings</span>
    </div>
  </div>
</div>

<div class="ad-page hidden" id="adPage">
  <div class="back-btn" onclick="goHome()"><i class="fas fa-arrow-left"></i> Back</div>
  <div class="quiz-buttons">
    <button onclick="loadQuiz()"><i class="fas fa-play-circle"></i> Start Earning</button>
    <button onclick="loadQuiz()"><i class="fas fa-video"></i> Watch Premium Ad</button>
  </div>
  <div class="developer-container">
    <div class="developer-text">Developer By SABBIR | EASY EARN BD | Earn Money Daily | 100% Free</div>
  </div>
</div>

<div class="referral-page hidden" id="referralPage">
  <div class="back-btn" onclick="goHome()"><i class="fas fa-arrow-left"></i> Back</div>
  <div class="section-title">
    <i class="fas fa-user-friends"></i>
    <h2>Referral Program</h2>
  </div>
  <p><strong>Your Referral Link:</strong></p>
  <div style="display: flex; align-items: center; margin-bottom: 20px;">
    <input type="text" id="referralLink" readonly />
    <button class="copy-btn" onclick="copyReferralLink()"><i class="fas fa-copy"></i> Copy</button>
  </div>
  <p style="font-size: 15px; margin-bottom: 25px; opacity: 0.8;">Share your referral link and earn rewards for every friend who joins!</p>
  <button class="share-btn" onclick="shareOnTelegram()">
    <i class="fab fa-telegram-plane"></i> Share on Telegram
  </button>
  
  <div class="referral-count">
    <p><strong>Total Referrals:</strong></p>
    <h3 id="referralCount">0</h3>
    <p>Active Users</p>
  </div>
</div>

<div class="notice-page hidden" id="noticePage">
  <div class="back-btn" onclick="goHome()"><i class="fas fa-arrow-left"></i> Back</div>
  <div class="notice-content">
    <div class="section-title">
      <i class="fas fa-bullhorn"></i>
      <h2>Important Notice</h2>
    </div>
    <p><strong class="earn-text">‡¶Ü‡ßü‡ßá‡¶∞ ‡¶∏‡¶π‡¶ú ‡¶ì ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶¶ ‡¶â‡¶™‡¶æ‡ßü!*</strong> üí∞üì≤</p>
    <p>‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ <span class="earn-text">EASY EARN BD</span> ‡¶•‡ßá‡¶ï‡ßá ‡¶Ü‡¶™‡¶®‡¶ø ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶¶‡¶ø‡¶® ‡¶∏‡¶π‡¶ú ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶ì ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶¶‡ßá‡¶ñ‡ßá ‡¶Ü‡ßü ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡¶®‡•§ ‚úÖ</p>
    <p>‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßÅ‡¶®, ‡¶Ü‡ßü ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø <strong>‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂/‡¶®‡¶ó‡¶¶‡ßá</strong> ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶§‡ßÅ‡¶≤‡ßÅ‡¶®‡•§ ü§ë</p>
    <p>‡¶ï‡ßã‡¶®‡ßã ‡¶á‡¶®‡¶≠‡ßá‡¶∏‡ßç‡¶ü‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶≤‡¶æ‡¶ó‡¶¨‡ßá ‡¶®‡¶æ ‚Äî <span class="earn-text">100% ‡¶´‡ßç‡¶∞‡¶ø ‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ!</span> üîì</p>
    <p>üî• ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶¶‡¶ø‡¶® ‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßá ‡¶∞‡¶ø‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶®‡¶ø‡¶®</p>
    <p>üì• ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®</p>
    <p>üí¨ <span class="earn-text">‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü</span> ‡¶ü‡¶ø‡¶Æ ‡¶∏‡¶¨‡¶∏‡¶Æ‡ßü ‡¶è‡¶ï‡¶ü‡¶ø‡¶≠</p>
    <p>üëâ ‡¶¨‡ßá‡¶∂‡¶ø ‡¶ï‡¶æ‡¶ú, ‡¶¨‡ßá‡¶∂‡¶ø ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ!</p>
    <p>üëâ ‡¶®‡¶ø‡ßü‡¶Æ‡¶ø‡¶§ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶Ü‡ßü ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p>
    <p><em>‡¶∂‡ßÅ‡¶≠ ‡¶ï‡¶æ‡¶Æ‡¶®‡¶æ! ‚ù§Ô∏è</em></p>
    <p>‚Äî ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ü‡ßü‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßÄ <span class="earn-text">EASY EARN BD</span> ‚ú®</p>
  </div>
</div>

<div class="withdraw-page hidden" id="withdrawPage">
  <div class="back-btn" onclick="goHome()"><i class="fas fa-arrow-left"></i> Back</div>
  <div class="withdraw-form">
    <div class="section-title">
      <i class="fas fa-wallet"></i>
      <h2>‡¶ü‡¶æ‡¶ï‡¶æ ‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</h2>
    </div>
    <p>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶â‡¶™‡¶æ‡¶∞‡ßç‡¶ú‡¶ø‡¶§ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶® ‡¶ï‡¶∞‡¶§‡ßá ‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶´‡¶∞‡ßç‡¶Æ‡¶ü‡¶ø ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®:</p>
    
    <select id="withdrawMethod">
      <option value="">‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶Æ‡ßá‡¶•‡¶° ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</option>
      <option value="bkash">‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂</option>
      <option value="nagad">‡¶®‡¶ó‡¶¶</option>
      <option value="rocket">‡¶∞‡¶ï‡ßá‡¶ü</option>
    </select>
    
    <input type="text" id="accountNumber" placeholder="‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ (01XXXXXXXXX)" />
    
    <input type="number" id="withdrawAmount" placeholder="‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶®‡ßá‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ (‡ß≥)" min="30" />
    
    <button onclick="submitWithdraw()"><i class="fas fa-paper-plane"></i> ‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶® ‡¶∞‡¶ø‡¶ï‡ßã‡¶Ø‡¶º‡ßá‡¶∏‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    
    <p style="margin-top: 20px; font-size: 14px; color: #00b09b;">
      <strong>‡¶®‡ßã‡¶ü:</strong> ‡¶∏‡¶∞‡ßç‡¶¨‡¶®‡¶ø‡¶Æ‡ßç‡¶® ‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶®‡ßá‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ ‡ß≥‡ß©‡ß¶.‡ß¶‡ß¶
    </p>
  </div>
</div>

<div class="settings-page hidden" id="settingsPage">
  <div class="back-btn" onclick="goHome()"><i class="fas fa-arrow-left"></i> Back</div>
  <div class="theme-options">
    <div class="section-title">
      <i class="fas fa-palette"></i>
      <h2>App Appearance</h2>
    </div>
    <p>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡¶õ‡¶®‡ßç‡¶¶ ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßá‡¶∞ ‡¶•‡¶ø‡¶Æ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®:</p>
    
    <div class="theme-btn light-btn" onclick="setTheme('light')">
      <i class="fas fa-sun"></i>
      <span>‡¶π‡¶æ‡¶≤‡¶ï‡¶æ ‡¶•‡¶ø‡¶Æ</span>
    </div>
    
    <div class="theme-btn dark-btn" onclick="setTheme('dark')">
      <i class="fas fa-moon"></i>
      <span>‡¶ó‡¶æ‡ßù ‡¶•‡¶ø‡¶Æ</span>
    </div>
  </div>
</div>

<div class="support-page hidden" id="supportPage">
  <div class="back-btn" onclick="goHome()"><i class="fas fa-arrow-left"></i> Back</div>
  <div class="support-options">
    <div class="section-title">
      <i class="fas fa-headset"></i>
      <h2>Support</h2>
    </div>
    <p>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶®‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®:</p>
    
    <div class="support-btn" onclick="openTelegramSupport()">
      <i class="fab fa-telegram"></i>
      <span>‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü</span>
    </div>
    
    <div class="support-btn" onclick="openEmailSupport()">
      <i class="fas fa-envelope"></i>
      <span>‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü</span>
    </div>
  </div>
</div>

<div class="profile-page hidden" id="profilePage">
  <div class="back-btn" onclick="goHome()"><i class="fas fa-arrow-left"></i> Back</div>
  <div class="user-stats">
    <div class="section-title">
      <i class="fas fa-user"></i>
      <h2>User Profile</h2>
    </div>
    <p>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞‡¶ø‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶®:</p>
    
    <div>
      <span>‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶®‡¶æ‡¶Æ:</span>
      <span class="earn-text" id="profileUserName">User Name</span>
    </div>
    
    <div>
      <span>‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶¶‡ßá‡¶ñ‡¶æ:</span>
      <span class="earn-text" id="adsWatched">0</span>
    </div>
    
    <div>
      <span>‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏:</span>
      <span class="earn-text">‡ß≥<span id="profileUserBalance">0.00</span></span>
    </div>
    
    <div>
      <span>‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏:</span>
      <span class="earn-text" id="referralDevices">0</span>
    </div>
    
    <div>
      <span>‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶®‡ßá‡¶∞ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ:</span>
      <span class="earn-text" id="withdrawCount">0</span>
    </div>
    
    <div>
      <span>‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§ ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ:</span>
      <span class="earn-text" id="paymentMethods">None</span>
    </div>
  </div>
</div>

<div class="history-page hidden" id="historyPage">
  <div class="back-btn" onclick="goHome()"><i class="fas fa-arrow-left"></i> Back</div>
  <div>
    <div class="section-title">
      <i class="fas fa-history"></i>
      <h2>Transaction History</h2>
    </div>
    <p>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶®‡ßá‡¶∞ ‡¶∞‡ßá‡¶ï‡¶∞‡ßç‡¶°:</p>
    
    <div id="withdrawHistory">
      <!-- History items will be added here dynamically -->
    </div>
  </div>
</div>

<div id="quizModal" class="modal hidden">
  <div class="modal-content">
    <span class="close" onclick="closeQuizModal()">&times;</span>
    <div class="timer" id="quizTimer">5</div>
    <div class="quiz-question" id="quizQuestion">‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶Ü‡¶∏‡¶õ‡ßá...</div>
    <div class="quiz-options" id="quizOptions"></div>
    <!-- Ad result container (initially hidden) -->
    <div class="ad-result-container hidden" id="adResultContainer">
      <p id="adResultMessage"></p>
      <button class="ad-watch-btn" onclick="showAd()">
        <i class="fas fa-ad"></i> ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®
      </button>
    </div>
  </div>
</div>

<!-- Toast Notification -->
<div class="toast" id="toast"></div>

<script>
  // Initialize Telegram WebApp
  let tg;
  let user;
  
  // Initialize all values to 0
  let balance = 0.00;
  let score = 0;
  let level = 0;
  let referralCount = 0;
  let adsWatched = 0;
  let withdrawCount = 0;
  let paymentMethods = [];
  let withdrawHistory = [];
  let userName = "";

  // Initialize the app
  function initApp() {
    // Initialize Telegram - must be first to set `user`
    initTelegram();

    // Check if we have a saved username
    const savedUserName = localStorage.getItem('userName');
    if (savedUserName) {
      // Hide welcome page and show home page
      document.getElementById('welcomePage').classList.add('hidden');
      document.getElementById('homePage').classList.remove('hidden');
      
      // Set username
      userName = savedUserName;
      document.getElementById("username").innerText = userName;
      document.getElementById("profileUserName").innerText = userName;
      
      // Load saved app state
      loadAppState();
      updateBalance();
    } else {
      // Show welcome page for new user
      document.getElementById('welcomePage').classList.remove('hidden');
      if (user) {
        document.getElementById('userNameInput').value = user.first_name;
      }
    }
  }
  
  // Save user name
  function saveUserName() {
    const input = document.getElementById('userNameInput');
    const name = input.value.trim();
    
    if (name === "") {
      showToast("‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®");
      return;
    }
    
    // Save user name to localStorage
    localStorage.setItem('userName', name);
    userName = name;
    
    // Hide welcome page and show home page
    document.getElementById('welcomePage').classList.add('hidden');
    document.getElementById('homePage').classList.remove('hidden');
    
    // Set username in UI
    document.getElementById("username").innerText = userName;
    document.getElementById("profileUserName").innerText = userName;
    
    // Initialize app state for new user
    saveAppState();
  }
  
  // Load app state from localStorage
  function loadAppState() {
    const state = JSON.parse(localStorage.getItem('appState') || '{}');
    
    balance = state.balance || 0;
    score = state.score || 0;
    level = state.level || 0;
    referralCount = state.referralCount || 0;
    adsWatched = state.adsWatched || 0;
    withdrawCount = state.withdrawCount || 0;
    paymentMethods = state.paymentMethods || [];
    withdrawHistory = state.withdrawHistory || [];
  }
  
  // Save app state to localStorage
  function saveAppState() {
    const state = {
      balance,
      score,
      level,
      referralCount,
      adsWatched,
      withdrawCount,
      paymentMethods,
      withdrawHistory
    };
    
    localStorage.setItem('appState', JSON.stringify(state));
  }
  
  function initTelegram() {
    // Check if Telegram WebApp is available
    if (window.Telegram && window.Telegram.WebApp) {
      tg = window.Telegram.WebApp;
      tg.ready();
      user = tg.initDataUnsafe?.user;
      console.log("Telegram WebApp initialized");
    } else {
      console.log("Telegram WebApp not detected");
    }
  }
  
  // Generate unique referral link based on device ID
  function generateDeviceId() {
    return 'device-' + Math.random().toString(36).substr(2, 9) + '-' + Date.now().toString(36);
  }

  // Get or create device ID
  let deviceId = localStorage.getItem('deviceId');
  if (!deviceId) {
    deviceId = generateDeviceId();
    localStorage.setItem('deviceId', deviceId);
    console.log("Generated new device ID:", deviceId);
  }

  // Load saved theme
  const savedTheme = localStorage.getItem('theme');
  if (savedTheme) {
    setTheme(savedTheme);
  } else {
    setTheme('dark');
  }

  const quizList = [
    { question: "‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂‡ßá‡¶∞ ‡¶∞‡¶æ‡¶ú‡¶ß‡¶æ‡¶®‡ßÄ ‡¶ï‡ßã‡¶®‡¶ü‡¶ø?", options: ["‡¶ö‡¶ü‡ßç‡¶ü‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ", "‡¶¢‡¶æ‡¶ï‡¶æ", "‡¶∞‡¶æ‡¶ú‡¶∂‡¶æ‡¶π‡ßÄ", "‡¶ñ‡ßÅ‡¶≤‡¶®‡¶æ"], answer: "‡¶¢‡¶æ‡¶ï‡¶æ" },
    { question: "‡ß´ x ‡ß¨ = ?", options: ["‡ß©‡ß¶", "‡ß®‡ß´", "‡ß©‡ß´", "‡ß™‡ß¶"], answer: "‡ß©‡ß¶" },
    { question: "‡¶∏‡¶¨‡¶ö‡ßá‡ßü‡ßá ‡¶¨‡ßú ‡¶Æ‡¶π‡¶æ‡¶∏‡¶æ‡¶ó‡¶∞ ‡¶ï‡ßã‡¶®‡¶ü‡¶ø?", options: ["‡¶Ü‡¶ü‡¶≤‡¶æ‡¶®‡ßç‡¶ü‡¶ø‡¶ï", "‡¶™‡ßç‡¶Ø‡¶æ‡¶∏‡¶ø‡¶´‡¶ø‡¶ï", "‡¶≠‡¶æ‡¶∞‡¶§", "‡¶Ü‡¶∞‡ßç‡¶ï‡¶ü‡¶ø‡¶ï"], answer: "‡¶™‡ßç‡¶Ø‡¶æ‡¶∏‡¶ø‡¶´‡¶ø‡¶ï" },
    { question: "‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶ï‡¶¨‡ßá ‡¶∏‡ßç‡¶¨‡¶æ‡¶ß‡ßÄ‡¶®‡¶§‡¶æ ‡¶≤‡¶æ‡¶≠ ‡¶ï‡¶∞‡ßá?", options: ["‡ßß‡ßØ‡ß≠‡ßß", "‡ßß‡ßØ‡ß≠‡ß´", "‡ßß‡ßØ‡ß™‡ß≠", "‡ßß‡ßØ‡ßØ‡ß¶"], answer: "‡ßß‡ßØ‡ß≠‡ßß" },
    { question: "‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶®‡ßá ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶ß‡¶æ‡¶®‡¶Æ‡¶®‡ßç‡¶§‡ßç‡¶∞‡ßÄ ‡¶ï‡ßá?", options: ["‡¶ñ‡¶æ‡¶≤‡ßá‡¶¶‡¶æ ‡¶ú‡¶ø‡¶Ø‡¶º‡¶æ", "‡¶∂‡ßá‡¶ñ ‡¶π‡¶æ‡¶∏‡¶ø‡¶®‡¶æ", "‡¶è‡¶∞‡¶∂‡¶æ‡¶¶", "‡¶ú‡¶ø‡¶Ø‡¶º‡¶æ ‡¶∞‡¶π‡¶Æ‡¶æ‡¶®"], answer: "‡¶∂‡ßá‡¶ñ ‡¶π‡¶æ‡¶∏‡¶ø‡¶®‡¶æ" },
    { question: "‡¶∏‡ßÇ‡¶∞‡ßç‡¶Ø‡ßá‡¶∞ ‡¶∏‡¶¨‡¶ö‡ßá‡¶Ø‡¶º‡ßá ‡¶ï‡¶æ‡¶õ‡ßá‡¶∞ ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡ßã‡¶®‡¶ü‡¶ø?", options: ["‡¶¨‡ßÅ‡¶ß", "‡¶∂‡ßÅ‡¶ï‡ßç‡¶∞", "‡¶™‡ßÉ‡¶•‡¶ø‡¶¨‡ßÄ", "‡¶Æ‡¶ô‡ßç‡¶ó‡¶≤"], answer: "‡¶¨‡ßÅ‡¶ß" },
    { question: "‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂‡ßá‡¶∞ ‡¶ú‡¶æ‡¶§‡ßÄ‡¶Ø‡¶º ‡¶™‡¶∂‡ßÅ ‡¶ï‡ßã‡¶®‡¶ü‡¶ø?", options: ["‡¶¨‡¶æ‡¶ò", "‡¶π‡¶æ‡¶§‡¶ø", "‡¶ò‡ßã‡¶°‡¶º‡¶æ", "‡¶≠‡¶æ‡¶≤‡ßç‡¶≤‡ßÅ‡¶ï"], answer: "‡¶¨‡¶æ‡¶ò" },
    { question: "‡¶ú‡¶≤‡ßÄ‡¶Ø‡¶º ‡¶¨‡¶æ‡¶∑‡ßç‡¶™ ‡¶ú‡¶Æ‡ßá ‡¶ï‡ßÄ ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡¶Ø‡¶º?", options: ["‡¶§‡ßÅ‡¶∑‡¶æ‡¶∞", "‡¶ï‡ßÅ‡¶Ø‡¶º‡¶æ‡¶∂‡¶æ", "‡¶¨‡ßÉ‡¶∑‡ßç‡¶ü‡¶ø", "‡¶∏‡¶æ‡¶ó‡¶∞"], answer: "‡¶ï‡ßÅ‡¶Ø‡¶º‡¶æ‡¶∂‡¶æ" },
    { question: "‡¶™‡ßÉ‡¶•‡¶ø‡¶¨‡ßÄ‡¶∞ ‡¶∏‡¶¨‡¶ö‡ßá‡¶Ø‡¶º‡ßá ‡¶¨‡¶°‡¶º ‡¶Æ‡¶π‡¶æ‡¶¶‡ßá‡¶∂ ‡¶ï‡ßã‡¶®‡¶ü‡¶ø?", options: ["‡¶á‡¶â‡¶∞‡ßã‡¶™", "‡¶è‡¶∂‡¶ø‡¶Ø‡¶º‡¶æ", "‡¶Ü‡¶´‡ßç‡¶∞‡¶ø‡¶ï‡¶æ", "‡¶¶‡¶ï‡ßç‡¶∑‡¶ø‡¶£ ‡¶Ü‡¶Æ‡ßá‡¶∞‡¶ø‡¶ï‡¶æ"], answer: "‡¶è‡¶∂‡¶ø‡¶Ø‡¶º‡¶æ" },
    { question: "‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂‡ßá‡¶∞ ‡¶Æ‡ßÅ‡¶¶‡ßç‡¶∞‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶ï‡ßÄ?", options: ["‡¶∞‡ßÅ‡¶™‡¶ø", "‡¶ü‡¶æ‡¶ï‡¶æ", "‡¶°‡¶≤‡¶æ‡¶∞", "‡¶á‡¶â‡¶∞‡ßã"], answer: "‡¶ü‡¶æ‡¶ï‡¶æ" },
    { question: "‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡¶æ‡¶û‡ßç‡¶ö‡¶≤‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶®‡ßÅ‡¶∑ ‡¶™‡ßç‡¶∞‡¶ß‡¶æ‡¶®‡¶§ ‡¶ï‡ßÄ ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßá?", options: ["‡¶Æ‡ßé‡¶∏‡ßç‡¶Ø ‡¶∂‡¶ø‡¶ï‡¶æ‡¶∞", "‡¶ö‡¶æ‡¶∑‡¶æ‡¶¨‡¶æ‡¶¶", "‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶ï‡¶§‡¶æ", "‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡¶æ"], answer: "‡¶ö‡¶æ‡¶∑‡¶æ‡¶¨‡¶æ‡¶¶" },
    { question: "‡¶Ü‡¶¨‡ßç‡¶∞‡¶æ‡¶π‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶Ç‡¶ï‡¶® ‡¶ï‡ßã‡¶® ‡¶¶‡ßá‡¶∂‡ßá‡¶∞ ‡¶∞‡¶æ‡¶∑‡ßç‡¶ü‡ßç‡¶∞‡¶™‡¶§‡¶ø ‡¶õ‡¶ø‡¶≤‡ßá‡¶®?", options: ["‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§‡¶∞‡¶æ‡¶ú‡ßç‡¶Ø", "‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂", "‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§‡¶∞‡¶æ‡¶∑‡ßç‡¶ü‡ßç‡¶∞", "‡¶ú‡¶æ‡¶™‡¶æ‡¶®"], answer: "‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§‡¶∞‡¶æ‡¶∑‡ßç‡¶ü‡ßç‡¶∞" },
    { question: "‡¶∞‡¶¨‡ßÄ‡¶®‡ßç‡¶¶‡ßç‡¶∞‡¶®‡¶æ‡¶• ‡¶†‡¶æ‡¶ï‡ßÅ‡¶∞ ‡¶ï‡ßã‡¶® ‡¶≠‡¶æ‡¶∑‡¶æ‡¶Ø‡¶º ‡¶≤‡¶ø‡¶ñ‡¶§‡ßá‡¶®?", options: ["‡¶π‡¶ø‡¶®‡ßç‡¶¶‡¶ø", "‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ", "‡¶á‡¶Ç‡¶∞‡ßá‡¶ú‡¶ø", "‡¶â‡¶∞‡ßç‡¶¶‡ßÅ"], answer: "‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ" },
    { question: "‡¶ï‡¶Æ‡ßç‡¶™‡¶ø‡¶â‡¶ü‡¶æ‡¶∞‡ßá‡¶∞ ‡¶ú‡¶®‡¶ï ‡¶ï‡¶æ‡¶ï‡ßá ‡¶¨‡¶≤‡¶æ ‡¶π‡¶Ø‡¶º?", options: ["‡¶Ü‡¶á‡¶ú‡ßç‡¶Ø‡¶æ‡¶ï ‡¶®‡¶ø‡¶â‡¶ü‡¶®", "‡¶ö‡¶æ‡¶∞‡ßç‡¶≤‡¶∏ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶¨‡ßá‡¶ú", "‡¶ü‡¶Æ‡¶æ‡¶∏ ‡¶è‡¶°‡¶ø‡¶∏‡¶®", "‡¶Ü‡¶≤‡¶¨‡¶æ‡¶∞‡ßç‡¶ü ‡¶Ü‡¶á‡¶®‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶®"], answer: "‡¶ö‡¶æ‡¶∞‡ßç‡¶≤‡¶∏ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶¨‡ßá‡¶ú" },
    { question: "‡¶è‡¶ï ‡¶°‡¶ú‡¶® ‡¶Æ‡¶æ‡¶®‡ßá ‡¶ï‡¶§?", options: ["‡ß¨", "‡ßß‡ß¶", "‡ßß‡ß®", "‡ß®‡ß¶"], answer: "‡ßß‡ß®" },
    { question: "‡¶¶‡¶ï‡ßç‡¶∑‡¶ø‡¶£ ‡¶Æ‡ßá‡¶∞‡ßÅ‡¶§‡ßá ‡¶∏‡¶¨‡¶ö‡ßá‡¶Ø‡¶º‡ßá ‡¶¨‡ßá‡¶∂‡¶ø ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º ‡¶ï‡ßã‡¶® ‡¶™‡ßç‡¶∞‡¶æ‡¶£‡ßÄ?", options: ["‡¶∏‡¶ø‡¶Ç‡¶π", "‡¶≠‡¶æ‡¶≤‡ßç‡¶≤‡ßÅ‡¶ï", "‡¶™‡ßá‡¶ô‡ßç‡¶ó‡ßÅ‡¶á‡¶®", "‡¶π‡¶∞‡¶ø‡¶£"], answer: "‡¶™‡ßá‡¶ô‡ßç‡¶ó‡ßÅ‡¶á‡¶®" },
    { question: "‡¶∏‡ßÇ‡¶∞‡ßç‡¶Ø ‡¶ï‡ßã‡¶•‡¶æ ‡¶•‡ßá‡¶ï‡ßá ‡¶â‡¶†‡ßá?", options: ["‡¶™‡¶∂‡ßç‡¶ö‡¶ø‡¶Æ", "‡¶â‡¶§‡ßç‡¶§‡¶∞", "‡¶™‡ßÇ‡¶∞‡ßç‡¶¨", "‡¶¶‡¶ï‡ßç‡¶∑‡¶ø‡¶£"], answer: "‡¶™‡ßÇ‡¶∞‡ßç‡¶¨" },
    { question: "‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂‡ßá‡¶∞ ‡¶ú‡¶æ‡¶§‡ßÄ‡¶Ø‡¶º ‡¶´‡ßÅ‡¶≤ ‡¶ï‡ßÄ?", options: ["‡¶ó‡ßã‡¶≤‡¶æ‡¶™", "‡¶∂‡¶æ‡¶™‡¶≤‡¶æ", "‡¶ú‡ßÅ‡¶Å‡¶á", "‡¶∏‡ßÇ‡¶∞‡ßç‡¶Ø‡¶Æ‡ßÅ‡¶ñ‡ßÄ"], answer: "‡¶∂‡¶æ‡¶™‡¶≤‡¶æ" },
    { question: "‡¶∏‡¶Æ‡ßÅ‡¶¶‡ßç‡¶∞‡ßá‡¶∞ ‡¶™‡¶æ‡¶®‡¶ø‡¶∞ ‡¶∏‡ßç‡¶¨‡¶æ‡¶¶ ‡¶ï‡ßá‡¶Æ‡¶®?", options: ["‡¶Æ‡¶ø‡¶∑‡ßç‡¶ü‡¶ø", "‡¶≤‡¶¨‡¶£‡¶æ‡¶ï‡ßç‡¶§", "‡¶´‡¶ø‡¶ï‡ßá", "‡¶ù‡¶æ‡¶≤"], answer: "‡¶≤‡¶¨‡¶£‡¶æ‡¶ï‡ßç‡¶§" },
    { question: "‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶Æ‡¶æ‡¶®‡ßÅ‡¶∑ ‡¶ö‡¶æ‡¶Å‡¶¶‡ßá ‡¶Ö‡¶¨‡¶§‡¶∞‡¶£ ‡¶ï‡¶∞‡ßá‡¶® ‡¶ï‡¶¨‡ßá?", options: ["‡ßß‡ßØ‡ß¨‡ßØ", "‡ßß‡ßØ‡ß≠‡ß´", "‡ßß‡ßØ‡ßÆ‡ß¶", "‡ßß‡ßØ‡ß´‡ß¶"], answer: "‡ßß‡ßØ‡ß¨‡ßØ" }
  ];

  let quizTimerInterval;

  function updateBalance() {
    document.getElementById("balance").innerText = balance.toFixed(2);
    document.getElementById("score").innerText = score;
    document.getElementById("level").innerText = level;
    document.getElementById("profileUserBalance").innerText = balance.toFixed(2);
    document.getElementById("adsWatched").innerText = adsWatched;
    document.getElementById("referralDevices").innerText = referralCount;
    document.getElementById("withdrawCount").innerText = withdrawCount;
    document.getElementById("paymentMethods").innerText = paymentMethods.join(", ") || "None";
    updateLevelProgress();
    saveAppState();
  }
  
  function updateLevelProgress() {
    const progress = (score % 20) * 5;
    document.getElementById("levelProgress").style.width = `${progress}%`;
    document.getElementById("progressPercentage").innerText = `${progress}%`;
  }

  function goToNoticePage() {
    document.getElementById("homePage").classList.add("hidden");
    document.getElementById("noticePage").classList.remove("hidden");
  }

  function goToWithdrawPage() {
    document.getElementById("homePage").classList.add("hidden");
    document.getElementById("withdrawPage").classList.remove("hidden");
  }

  function goToSettingsPage() {
    document.getElementById("homePage").classList.add("hidden");
    document.getElementById("settingsPage").classList.remove("hidden");
  }

  function goToSupportPage() {
    document.getElementById("homePage").classList.add("hidden");
    document.getElementById("supportPage").classList.remove("hidden");
  }

  function goToProfilePage() {
    document.getElementById("homePage").classList.add("hidden");
    document.getElementById("profilePage").classList.remove("hidden");
    
    // Update profile stats
    updateBalance();
  }

  function goToHistoryPage() {
    document.getElementById("homePage").classList.add("hidden");
    document.getElementById("historyPage").classList.remove("hidden");
    updateWithdrawHistory();
  }

  function openTelegramChannel() {
    window.open("https://t.me/EAS_YEARN_BD", "_blank");
  }

  function openTelegramSupport() {
    window.open("https://t.me/EAS_YEARN_BD", "_blank");
  }

  function openEmailSupport() {
    window.location.href = "mailto:support@easyearnbd.com";
  }

  function goToAdPage() {
    document.getElementById("homePage").classList.add("hidden");
    document.getElementById("adPage").classList.remove("hidden");
  }

  function goHome() {
    document.getElementById("homePage").classList.remove("hidden");
    document.getElementById("adPage").classList.add("hidden");
    document.getElementById("referralPage").classList.add("hidden");
    document.getElementById("noticePage").classList.add("hidden");
    document.getElementById("withdrawPage").classList.add("hidden");
    document.getElementById("settingsPage").classList.add("hidden");
    document.getElementById("supportPage").classList.add("hidden");
    document.getElementById("profilePage").classList.add("hidden");
    document.getElementById("historyPage").classList.add("hidden");
  }

  function goToReferralPage() {
    document.getElementById("homePage").classList.add("hidden");
    document.getElementById("referralPage").classList.remove("hidden");

    // Use Telegram user ID if available, otherwise use device ID
    const userId = user ? user.id : deviceId;
    const referralLink = `https://easyearnbd.com/?ref=${userId}`;
    document.getElementById("referralLink").value = referralLink;
    document.getElementById("referralCount").innerText = referralCount;
    console.log("Referral link generated:", referralLink);
  }

  function copyReferralLink() {
    const input = document.getElementById("referralLink");
    input.select();
    input.setSelectionRange(0, 99999);
    document.execCommand("copy");
    
    // Visual feedback
    const btn = document.querySelector('.copy-btn');
    btn.innerHTML = '<i class="fas fa-check"></i> Copied!';
    setTimeout(() => {
      btn.innerHTML = '<i class="fas fa-copy"></i> Copy';
    }, 2000);
    
    showToast("Referral link copied to clipboard!");
  }

  function shareOnTelegram() {
    const link = document.getElementById("referralLink").value;
    const text = encodeURIComponent("üöÄ Join EASY EARN BD and earn rewards! " + link);
    window.open(`https://t.me/share/url?url=${text}`, "_blank");
  }

  // Function to show ad result message and button
  function showAdPrompt(message) {
    // Hide quiz elements
    document.getElementById("quizTimer").classList.add("hidden");
    document.getElementById("quizQuestion").classList.add("hidden");
    document.getElementById("quizOptions").classList.add("hidden");
    
    // Show ad result container
    document.getElementById("adResultMessage").innerText = message;
    document.getElementById("adResultContainer").classList.remove("hidden");
  }

  // Function to show the ad
  function showAd() {
    // Hide the ad prompt button
    document.getElementById("adResultContainer").classList.add("hidden");
    
    // Show loading indicator
    document.getElementById("quizQuestion").innerText = "‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...";
    document.getElementById("quizQuestion").classList.remove("hidden");
    
    // Show the ad
    if (typeof show_9659158 === 'function') {
      show_9659158().then(() => {
        // Reward user for watching the ad
        balance += 0.10;
        adsWatched += 1;
        updateBalance();
        showToast("‚úÖ ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ß‡¶®‡ßç‡¶Ø‡¶¨‡¶æ‡¶¶! ‡¶Ü‡¶™‡¶®‡¶ø ‡ß≥0.10 ‡¶™‡ßá‡¶≤‡ßá‡¶®");
        
        // Close the modal after ad completes
        setTimeout(() => {
          closeQuizModal();
        }, 2000);
      }).catch((error) => {
        console.error('Ad error:', error);
        showToast("‚ùå ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§ ‡¶™‡¶∞‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®");
        closeQuizModal();
      });
    } else {
      showToast("‚ùå ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶∏‡ßá‡¶¨‡¶æ ‡¶è‡¶ñ‡¶® ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡¶ö‡ßç‡¶õ‡ßá ‡¶®‡¶æ");
      closeQuizModal();
    }
  }

  // Modified quiz answer handler
  function setupQuizAnswerHandler(btn, opt, quiz) {
    btn.onclick = () => {
      clearInterval(quizTimerInterval);
      
      if (opt === quiz.answer) {
        // Correct answer
        balance += 0.20;
        score += 1;
        adsWatched += 1;
        if (score % 20 === 0) level += 1;
        updateBalance();
        
        // Show ad prompt for correct answer
        showAdPrompt("‚úÖ ‡¶∏‡¶†‡¶ø‡¶ï ‡¶â‡¶§‡ßç‡¶§‡¶∞! ‡¶Ü‡¶™‡¶®‡¶ø ‡ß≥0.20 ‡¶™‡ßá‡¶≤‡ßá‡¶®‡•§ ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶¶‡ßá‡¶ñ‡ßá ‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡ß≥0.10 ‡¶â‡¶™‡¶æ‡¶∞‡ßç‡¶ú‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®");
      } else {
        // Wrong answer
        adsWatched += 1;
        updateBalance();
        
        // Show ad prompt for wrong answer
        showAdPrompt("‚ùå ‡¶≠‡ßÅ‡¶≤ ‡¶â‡¶§‡ßç‡¶§‡¶∞! ‡¶™‡¶∞‡ßá‡¶∞ ‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§ ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶¶‡ßá‡¶ñ‡ßá ‡ß≥0.10 ‡¶â‡¶™‡¶æ‡¶∞‡ßç‡¶ú‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®");
      }
    };
  }

  function loadQuiz() {
    const quiz = quizList[Math.floor(Math.random() * quizList.length)];
    document.getElementById("quizModal").classList.remove("hidden");
    document.getElementById("quizQuestion").innerText = quiz.question;
    
    // Reset ad result container
    document.getElementById("adResultContainer").classList.add("hidden");
    document.getElementById("quizTimer").classList.remove("hidden");
    document.getElementById("quizQuestion").classList.remove("hidden");
    document.getElementById("quizOptions").classList.remove("hidden");

    const optionsEl = document.getElementById("quizOptions");
    optionsEl.innerHTML = "";

    quiz.options.forEach(opt => {
      const btn = document.createElement("button");
      btn.innerText = opt;
      setupQuizAnswerHandler(btn, opt, quiz);
      optionsEl.appendChild(btn);
    });

    startQuizTimer();
  }

  function startQuizTimer() {
    let timeLeft = 5;
    const timerEl = document.getElementById("quizTimer");
    timerEl.innerText = timeLeft;

    quizTimerInterval = setInterval(() => {
      timeLeft--;
      timerEl.innerText = timeLeft;

      if (timeLeft <= 0) {
        clearInterval(quizTimerInterval);
        showToast("üïí ‡¶∏‡¶Æ‡ßü ‡¶∂‡ßá‡¶∑! ‡¶™‡¶∞‡ßá‡¶∞ ‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®");
        adsWatched += 1;
        updateBalance();
        closeQuizModal();
      }
    }, 1000);
  }

  function closeQuizModal() {
    document.getElementById("quizModal").classList.add("hidden");
    clearInterval(quizTimerInterval);
    
    // Reset modal to original state
    document.getElementById("quizTimer").classList.remove("hidden");
    document.getElementById("quizQuestion").classList.remove("hidden");
    document.getElementById("quizOptions").classList.remove("hidden");
    document.getElementById("adResultContainer").classList.add("hidden");
  }

  function submitWithdraw() {
    const method = document.getElementById("withdrawMethod").value;
    const account = document.getElementById("accountNumber").value;
    const amount = parseFloat(document.getElementById("withdrawAmount").value);
    
    if (!method) {
      showToast("‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶Æ‡ßá‡¶•‡¶° ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®");
      return;
    }
    
    if (!account || account.length < 11) {
      showToast("‡¶∏‡¶†‡¶ø‡¶ï ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶¶‡¶ø‡¶®");
      return;
    }
    
    if (!amount || amount < 30) {
      showToast("‡¶∏‡¶∞‡ßç‡¶¨‡¶®‡¶ø‡¶Æ‡ßç‡¶® ‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶®‡ßá‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ ‡ß≥‡ß©‡ß¶");
      return;
    }
    
    if (amount > balance) {
      showToast("‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶Ø‡¶•‡ßá‡¶∑‡ßç‡¶ü ‡¶®‡ßü");
      return;
    }
    
    balance -= amount;
    withdrawCount += 1;
    if (!paymentMethods.includes(method)) {
      paymentMethods.push(method);
    }
    
    // Add to withdraw history
    const now = new Date();
    const historyItem = {
      method: method,
      account: account,
      amount: amount,
      date: now.toLocaleDateString('bn-BD'),
      time: now.toLocaleTimeString('bn-BD')
    };
    withdrawHistory.push(historyItem);
    
    updateBalance();
    showToast("‚úÖ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶® ‡¶∞‡¶ø‡¶ï‡ßã‡¶Ø‡¶º‡ßá‡¶∏‡ßç‡¶ü ‡¶ú‡¶Æ‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá! ‡ß®‡ß™ ‡¶ò‡¶®‡ßç‡¶ü‡¶æ‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶™‡ßá‡ßü‡ßá ‡¶Ø‡¶æ‡¶¨‡ßá‡¶®");
    saveAppState();
    goHome();
  }

  function updateWithdrawHistory() {
    const historyContainer = document.getElementById("withdrawHistory");
    historyContainer.innerHTML = "";
    
    if (withdrawHistory.length === 0) {
      historyContainer.innerHTML = '<div class="history-item"><p>‡¶ï‡ßã‡¶®‡ßã ‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶®‡ßá‡¶∞ ‡¶á‡¶§‡¶ø‡¶π‡¶æ‡¶∏ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø</p></div>';
      return;
    }
    
    withdrawHistory.forEach(item => {
      const historyItem = document.createElement("div");
      historyItem.className = "history-item";
      
      historyItem.innerHTML = `
        <div>
          <span>‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ:</span>
          <span class="earn-text">${getMethodName(item.method)}</span>
        </div>
        <div>
          <span>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞:</span>
          <span>${item.account}</span>
        </div>
        <div>
          <span>‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£:</span>
          <span class="earn-text">‡ß≥${item.amount.toFixed(2)}</span>
        </div>
        <div>
          <span>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ:</span>
          <span>${item.date}</span>
        </div>
        <div>
          <span>‡¶∏‡¶Æ‡¶Ø‡¶º:</span>
          <span>${item.time}</span>
        </div>
      `;
      
      historyContainer.appendChild(historyItem);
    });
  }

  function getMethodName(method) {
    switch(method) {
      case 'bkash': return '‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂';
      case 'nagad': return '‡¶®‡¶ó‡¶¶';
      case 'rocket': return '‡¶∞‡¶ï‡ßá‡¶ü';
      default: return method;
    }
  }

  function setTheme(theme) {
    const body = document.getElementById("appBody");
    body.className = theme + '-theme';
    localStorage.setItem('theme', theme);
    
    // Add subtle animation to cards
    const cards = document.querySelectorAll('.card');
    cards.forEach(card => {
      card.style.animation = 'pulse 0.5s ease';
      setTimeout(() => {
        card.style.animation = '';
      }, 500);
    });
    
    showToast(`Theme changed to ${theme === 'dark' ? '‡¶ó‡¶æ‡ßù ‡¶•‡¶ø‡¶Æ' : '‡¶π‡¶æ‡¶≤‡¶ï‡¶æ ‡¶•‡¶ø‡¶Æ'}`);
  }
  
  // Show toast notification
  function showToast(message) {
    const toast = document.getElementById('toast');
    toast.textContent = message;
    toast.classList.add('show');
    
    setTimeout(() => {
      toast.classList.remove('show');
    }, 3000);
  }
  
  // Initialize app
  initApp();
  
  // Add animation for app name
  const appName = document.querySelector('.app-name');
  setInterval(() => {
    appName.style.textShadow = '0 0 15px rgba(0, 176, 155, 0.7)';
    setTimeout(() => {
      appName.style.textShadow = '0 2px 8px rgba(0,0,0,0.2)';
    }, 1000);
  }, 3000);
</script>
</body>
</html>
